---
title: Top 10 Countries with the Highest Greenhouse Gas Emissions
format:
  poster-typst: 
    size: "33x23" # Approximately A1
    poster-authors: "Ryan Chua, Woon Jun Wei, Ong Shi Hui, Chua Kang Le, Phua Tiffany, Loo Siong Yu"
    institution-logo: "./images/sit-logo.png"
    footer-text: "CSC3107 Information Visualization"
    footer-emails: "Team Bisque"
execute:
  echo: false
knitr:
  opts_chunk:
    dev: svglite
---

```{r}
#| label: setup
#| include: false

library(knitr)
purl("ghg_prep.qmd")
source("ghg_prep.R")
```

# Introduction


Greenhouse gas (GHG) emissions from human activities such as fossil fuel combustion, deforestation, and industrial processes significantly contribute to climate change. The primary GHGs—carbon dioxide (CO$_2$), methane (CH$_4$), nitrous oxide (N$_2$O), and fluorinated gases—trap heat in the Earth's atmosphere, causing a warming effect known as the greenhouse effect. This results in rising global temperatures, disrupted weather patterns, and more frequent extreme weather events. For instance, global temperatures have increased by approximately 1.2°C since the late 19th century [^Jones1999Surface], and sea levels have risen by about 20 centimeters over the past century due to melting polar ice caps and glaciers, threatening various species' habitats. Beyond climate change, GHG emissions affect air quality and public health, leading to respiratory and cardiovascular diseases. The World Health Organization (WHO) estimates that air pollution causes around 3.3 million premature deaths annually [^Lelieveld2015The]. Additionally, the increased concentration of GHGs disrupts ecosystems and endangers biodiversity. Ocean acidification, resulting from excess CO$_2$ absorption by oceans, has risen by 30% since the Industrial Revolution [^Popattanachai2021Ocean], adversely impacting marine life, particularly coral reefs and shellfish.

[^Jones1999Surface]: Jones, P. D., New, M., Parker, D. E., Martin, S., & Rigor, I. G. (1999). Surface air temperature and its changes over the past 150 years. Reviews of Geophysics, 37(2), 173–199. doi:10.1029/1999rg900002

Visualizing GHG emissions is essential for understanding their distribution across countries and sectors, identifying major contributors, and informing policy decisions. The top 10 emitting countries—China, the United States, India, Russia, Japan, Germany, Iran, South Korea, Canada, and Saudi Arabia—account for a significant portion of global emissions. Major sectors contributing to these emissions include energy production, transportation, industrial processes, agriculture, and waste management. The energy sector is the largest source due to fossil fuel combustion, while the transportation sector significantly contributes through gasoline and diesel use. Highlighting these contributors underscores the need for coordinated climate action and promotes sustainable practices, renewable energy, and effective policies.


[^Lelieveld2015The]: Lelieveld, J., Evans, J., Fnais, M. et al. The contribution of outdoor air pollution sources to premature mortality on a global scale. Nature 525, 367–371 (2015). https://doi.org/10.1038/nature15371

[^Popattanachai2021Ocean]: Popattanachai, N., & A Kirk, E. (2021). "Chapter 4: Ocean acidification and multilateral environmental agreements". In Research Handbook on Ocean Acidification Law and Policy. Cheltenham, UK: Edward Elgar Publishing. Retrieved Jun 14, 2024, from https://doi.org/10.4337/9781789900149.00012 


# Previous Visualization
```{r}
#| label: fig-previous-vis
#| fig-cap: "Top 10 Countries with the Highest Greenhouse Gas Emissions by Sector"
#| out-width: 60%

include_graphics("images/old_visualization.jpg")
```

# Strengths
- **Clear Ranking**: The visualization clearly ranks the countries based on their emissions. (Size)
- **Color Coding**: The color coding helps differentiate between countries.
- **Contextual Information**: The visualization depicts the sectors emitting the greenhouse gases per country.

# Suggested Improvements

We decided to exclude the "Others" category from the previous visualization to enhance clarity and focus on the top 10 countries with the highest greenhouse gas emissions. This adjustment allows for a more straightforward comparison of emissions across these leading countries and their respective sectors. Additionally, we included a stacked bar chart to display the emissions by sector for these top 10 countries in comparison to the rest of the world. This approach provides a clearer understanding of the major contributors to global emissions and highlights the differences between the top emitters and other countries.

1. **Removed "Others" category:** Enhanced clarity by focusing on the top 10 countries with the highest greenhouse gas emissions.
2. **Donut chart:** Visualized the top 10 countries and their emission sectors, allowing for straightforward comparison.
3. **Stacked bar chart:** Added to show emissions by sector for the top 10 countries compared to the rest of the world.
4. **Enhanced comparison:** Improved understanding of major contributors to global emissions.
5. **Clear visualization:** Highlighted differences between top emitters and other countries.


# Implementation

## Data

- **Data Source:** The dataset used for this visualization was retrieved from the World Bank Data API [^climatewatchdata]. It includes greenhouse gas emissions data (CO2, F-Gas, N2O, CH4) by sector for various countries. We removed the 'Unit' column as it contained only one distinct value, "MtCO₂e," representing million metric tons of carbon dioxide equivalent.
- **Data Preparation:** We cleaned and transformed the dataset to compute total emissions by sector for each country and to identify the top 10 countries with the highest greenhouse gas emissions.
- **Sector Analysis:** Data was grouped by country and sector to determine the top three emitting sectors per country. Additionally, we calculated emissions per capita for the top 10 countries to provide further insights into emission trends.

[^climatewatchdata]: <https://www.climatewatchdata.org/ghg-emissions?end_year=2021&start_year=1990>


## Software

We used the Quarto publication framework and the R programming language, along with the following third-party packages:

<!-- To be updated -->

* *readxl* for data import
* *tidyverse* for data transformation, including *ggplot2* for visualization
  based on the grammar of graphics
* *knitr* for dynamic document generation
* *gt* for creating tables
* *wbstats* for retrieving data from the World Bank Data API
* *dplyr* for data manipulation

```{=typst}
#v(2em)
```


# Improved Visualization

```{r}
#| label: fig-ggplot
#| fig-cap: "Revised Visualization of Top 10 Countries with the Highest Greenhouse Gas Emissions by Sector"
#| fig-width: 3.2
#| fig-height: 2.3
#| out-width: 100%
#| warning: false

#TODO: Finalise and Cleanup this block
ggplot(treemap_data, aes(area = Emissions, fill = Sector, subgroup = Country)) +
  geom_treemap() +
  geom_treemap_text(
    aes(label = paste0(Sector, "\n", round(Emissions, 2), " MtCO2e")),
    reflow = TRUE,
    color = "white",
    place = "centre",
    grow = TRUE
  ) +
  geom_treemap_subgroup_text(
    place = "centre",
    grow = TRUE
  ) +
  geom_treemap_subgroup_border() +
  scale_fill_brewer(palette = "Set3") +
  theme_void() +
  theme(legend.position = "none") +
  labs(
    title = "Top 10 GHG Emitters",
    fill = "Sector",
    caption = "Source: World Resources Institute",
  )

# treemap(
#   dtf = treemap_data,
#   index = c("Country", "Sector"),
#   vSize = "Emissions",
#   vColor = "Emissions",
#   draw = TRUE,
#   title = "Top 10 GHG Emitters",
#   fontsize.labels = c(5, 8),
#   inflate.labels = TRUE,
#   # fontcolor.labels = c("black", "white"),
#   fontface.labels = c(2, 1),
#   fontsize.title = 3,  # Adjusted font size for title
#   align.labels = list(c("center", "center"), c("center", "center")),
#   border.col = "black",
#   border.lwds = 0.5,  # Adjusted border line width
#   aspRatio = NA,
#   type = "value",
#   palette = "Reds",
#   fontsize.legend = 5,  # Adjusted font size for legend
#   title.legend = "Emissions (MtCO2e)",  # Added legend title
#   format.legend = list(
#     # Show in million metric tons
#     big.mark = ",",
#     scientific = FALSE
#     
#   )
# )

# Map Here

# gg_ghg_total_emissions_final <- gg_ghg("Top GHG Emitters (as % of World Total)") +
#   aes(fill = Total_Emissions) +
#   labs(fill = NULL, caption = "Source: World Resources Institute") +
#   scale_fill_fermenter(
#     palette = "OrRd",
#     direction = 1,
#     labels = label_number(
#       scale = 1e-6,
#       suffix = "M"
#     )
#   ) +
#   geom_sf_text(
#     aes(label = country_label, color = label_colour),
#     data = world,
#     size = 1.25
#   ) +
#   scale_color_identity()

# gg_ghg_total_emissions_final

# Donut Chart Here

# ggPieDonut(
#   ghg_total_countries_gg,
#   aes(pies = Country, donuts = Sector, count = Emissions),
#   showRatioPie = FALSE,
#   showRatioDonut = FALSE,
#   title = "Top 10 GHG Emitters",
#   labelposition = 1
# ) +
#   geom_col(aes(x = -1, y = 0))

# Stacked Bar Chart Here

# Summarize the emissions of the top 10 countries
# top_10_countries <- ghg_total_sector |>
#   group_by(Country) |>
#   summarize(Total_Emissions = sum(Emissions)) |>
#   filter(Country != "Others") |>
#   top_n(10, Total_Emissions)

# Create a new data frame for the top 10 countries
# top_10_data <- ghg_total_sector |>
#   filter(Country %in% top_10_countries$Country) |>
#   group_by(Sector) |>
#   summarize(Emissions = sum(Emissions)) |>
#   mutate(Country = "Top 10")

# Create a new data frame for the "Others" countries
# others_data <- ghg_total_sector |>
#   filter(!Country %in% top_10_countries$Country) |>
#   group_by(Sector) |>
#   summarize(Emissions = sum(Emissions)) |>
#   mutate(Country = "Others")

# Combine the data frames
# final_data <- bind_rows(top_10_data, others_data)

# Plot the final stacked bar chart
# ggplot(final_data, aes(x = Emissions, y = Country, fill = Sector)) +
#   geom_bar(stat = "identity") +
#   theme_minimal() +
#   theme(
#     axis.text.x = element_text(angle = 45, hjust = 1),
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     plot.margin = margin(10, 10, 10, 10),
#     legend.position = "bottom",
#     legend.key.size = unit(0.5, "cm"),
#   ) +
#   labs(
#     title = "Top 10 GHG Emitters",
#     subtitle = "Emissions by Sector",
#     x = "Country",
#     y = "Emissions (MtCO₂e)",
#     fill = "Sector"
#   )
```

# Further Suggestions for Interactivity

To enhance user engagement and provide deeper insights, we recommend adding interactive features to the visualization. Specifically, implementing interactivity in the donut chart would allow users to hover over each segment and view detailed information about emissions by sector for each country. This interactive feature enables users to explore the data dynamically, gaining a better understanding of how emissions are distributed across different sectors and countries. Additionally, incorporating features such as tooltips, filters, and search functions can further enrich the user experience by facilitating interactive data exploration and analysis.

# Conclusion

We have refined the visualization of the top 10 countries with the highest greenhouse gas emissions to offer a clearer and more focused depiction of emissions by sector. By removing the "Others" category and emphasizing the leading emitters, we have improved the visualization's clarity and highlighted the primary contributors to global emissions. The inclusion of a donut chart and stacked bar chart provides a comprehensive overview of sector-specific emissions for these countries, facilitating effective comparisons across both countries and sectors. To enhance user engagement and facilitate data exploration, we recommend integrating interactive features. Visualizing greenhouse gas emissions plays a crucial role in raising awareness about climate change, advocating for sustainable practices, and informing policy decisions aimed at mitigating environmental impacts caused by human activities.
